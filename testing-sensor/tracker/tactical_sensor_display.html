<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TACTICAL SENSOR MONITORING SYSTEM</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Orbitron', monospace;
            background: #000;
            color: #0f0;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 0, 0.03) 2px,
                    rgba(0, 255, 0, 0.03) 4px
                );
            pointer-events: none;
            z-index: 1;
        }
        
        .scan-line {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(0, 255, 0, 0.5) 50%, 
                transparent 100%);
            animation: scan 3s linear infinite;
            z-index: 2;
        }
        
        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid #0f0;
            margin-bottom: 30px;
            position: relative;
            background: linear-gradient(180deg, rgba(0,20,0,0.9) 0%, transparent 100%);
        }
        
        h1 {
            font-size: 2.5em;
            font-weight: 900;
            text-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(0, 255, 0, 0.8); }
            to { text-shadow: 0 0 30px rgba(0, 255, 0, 1), 0 0 40px rgba(0, 255, 0, 0.6); }
        }
        
        .status-bar {
            display: flex;
            justify-content: space-around;
            padding: 10px;
            background: rgba(0, 20, 0, 0.8);
            border: 1px solid #0f0;
            margin-bottom: 20px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #0f0;
            animation: pulse 1s infinite;
        }
        
        .status-indicator.alert {
            background: #ff0;
            animation: pulse-alert 0.5s infinite;
        }
        
        .status-indicator.danger {
            background: #f00;
            animation: pulse-danger 0.3s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 5px currentColor; }
            50% { opacity: 0.5; box-shadow: 0 0 20px currentColor; }
        }
        
        @keyframes pulse-alert {
            0%, 100% { opacity: 1; box-shadow: 0 0 10px #ff0; }
            50% { opacity: 0.3; box-shadow: 0 0 30px #ff0; }
        }
        
        @keyframes pulse-danger {
            0%, 100% { opacity: 1; box-shadow: 0 0 10px #f00; }
            50% { opacity: 0.3; box-shadow: 0 0 40px #f00; }
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: rgba(0, 20, 0, 0.6);
            border: 2px solid #0f0;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .panel::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 0, 0.1), transparent);
            animation: sweep 8s linear infinite;
        }
        
        @keyframes sweep {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .panel-header {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .radar-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 400px;
            margin: 0 auto;
            background: radial-gradient(circle, transparent 0%, rgba(0, 255, 0, 0.1) 100%);
            border-radius: 50%;
            border: 2px solid #0f0;
            overflow: hidden;
        }
        
        .radar-sweep {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, rgba(0, 255, 0, 0.8) 0%, transparent 100%);
            transform-origin: left center;
            animation: radar-sweep 4s linear infinite;
        }
        
        @keyframes radar-sweep {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .radar-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .radar-circle {
            position: absolute;
            border: 1px solid rgba(0, 255, 0, 0.2);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .target-blip {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #f00;
            border-radius: 50%;
            animation: blip-fade 2s ease-out infinite;
        }
        
        @keyframes blip-fade {
            0% { 
                opacity: 1; 
                box-shadow: 0 0 10px #f00;
                transform: scale(1);
            }
            100% { 
                opacity: 0; 
                box-shadow: 0 0 30px transparent;
                transform: scale(2);
            }
        }
        
        .threat-assessment {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .threat-level {
            padding: 15px;
            background: rgba(0, 40, 0, 0.8);
            border-left: 4px solid #0f0;
            position: relative;
            overflow: hidden;
        }
        
        .threat-level.high {
            border-left-color: #f00;
            background: rgba(40, 0, 0, 0.8);
            animation: alert-flash 1s infinite;
        }
        
        .threat-level.medium {
            border-left-color: #ff0;
            background: rgba(40, 40, 0, 0.4);
        }
        
        @keyframes alert-flash {
            0%, 100% { background: rgba(40, 0, 0, 0.8); }
            50% { background: rgba(60, 0, 0, 0.9); }
        }
        
        .threat-label {
            font-size: 0.9em;
            opacity: 0.7;
            text-transform: uppercase;
        }
        
        .threat-value {
            font-size: 1.5em;
            font-weight: 700;
            margin-top: 5px;
        }
        
        .confidence-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 50, 0, 0.5);
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #0f0, #ff0);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px currentColor;
        }
        
        .streaming-data {
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            padding: 10px;
            background: #000;
            border: 1px solid #0f0;
        }
        
        .data-line {
            padding: 2px 0;
            opacity: 0;
            animation: data-stream 0.5s ease-out forwards;
            white-space: nowrap;
            overflow: hidden;
        }
        
        @keyframes data-stream {
            0% { 
                opacity: 0;
                transform: translateY(-10px);
            }
            100% { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .data-line.alert {
            color: #ff0;
            font-weight: bold;
        }
        
        .data-line.danger {
            color: #f00;
            font-weight: bold;
            animation: blink 0.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            padding: 20px;
            background: rgba(0, 20, 0, 0.8);
            border: 1px solid #0f0;
        }
        
        button {
            padding: 12px 30px;
            background: transparent;
            border: 2px solid #0f0;
            color: #0f0;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 2px;
        }
        
        button:hover:not(:disabled) {
            background: rgba(0, 255, 0, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
            transform: scale(1.05);
        }
        
        button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        button.active {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.8);
        }
        
        input[type="file"] {
            padding: 10px;
            background: rgba(0, 20, 0, 0.8);
            border: 2px solid #0f0;
            color: #0f0;
            font-family: 'Orbitron', monospace;
        }
        
        .timeline-container {
            background: rgba(0, 20, 0, 0.6);
            border: 2px solid #0f0;
            padding: 20px;
            margin-top: 30px;
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
        }
        
        .detection-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 0, 0, 0.9);
            border: 3px solid #f00;
            padding: 30px 60px;
            font-size: 2em;
            font-weight: 900;
            text-transform: uppercase;
            display: none;
            z-index: 1000;
            animation: alert-pulse 0.5s infinite;
            letter-spacing: 3px;
            box-shadow: 0 0 50px rgba(255, 0, 0, 0.8);
        }
        
        .detection-alert.show {
            display: block;
        }
        
        @keyframes alert-pulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.05);
                opacity: 0.8;
            }
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .metric {
            padding: 10px;
            background: rgba(0, 40, 0, 0.6);
            border: 1px solid rgba(0, 255, 0, 0.3);
        }
        
        .metric-label {
            font-size: 0.7em;
            opacity: 0.7;
            text-transform: uppercase;
        }
        
        .metric-value {
            font-size: 1.2em;
            font-weight: 700;
            color: #0ff;
            margin-top: 5px;
        }
        
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .classification-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #ff0;
            color: #000;
            text-align: center;
            padding: 5px;
            font-weight: 900;
            font-size: 14px;
            letter-spacing: 2px;
            z-index: 9999;
            border-bottom: 2px solid #000;
        }
        
        .classification-banner.bottom {
            top: auto;
            bottom: 0;
            border-bottom: none;
            border-top: 2px solid #000;
        }
        
        body {
            padding-top: 30px;
            padding-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="classification-banner">UNCLASSIFIED</div>
    <div class="classification-banner bottom">UNCLASSIFIED</div>
    
    <div class="scan-line"></div>
    
    <div class="container">
        <header>
            <h1>üõ°Ô∏è TACTICAL SENSOR MONITORING SYSTEM</h1>
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-indicator" id="systemStatus"></div>
                    <span>SYSTEM: <span id="systemStatusText">STANDBY</span></span>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="threatStatus"></div>
                    <span>THREAT LEVEL: <span id="threatLevelText">NOMINAL</span></span>
                </div>
                <div class="status-item">
                    <div class="status-indicator" id="dataStatus"></div>
                    <span>DATA STREAM: <span id="dataStreamText">OFFLINE</span></span>
                </div>
                <div class="status-item">
                    <span>TIME: <span id="currentTime">00:00:00</span></span>
                </div>
            </div>
        </header>
        
        <div class="controls">
            <input type="file" id="fileInput" accept=".har">
            <button id="loadBtn">LOAD DATA</button>
            <button id="streamBtn" disabled>START STREAM</button>
            <button id="resetBtn" disabled>RESET</button>
        </div>
        
        <div class="main-grid">
            <div class="panel">
                <div class="panel-header">Target Classification</div>
                <div class="threat-assessment" id="threatAssessment">
                    <div class="threat-level" id="personThreat">
                        <div class="threat-label">Person Detection</div>
                        <div class="threat-value" id="personConfidence">0.00%</div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="personConfidenceBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="threat-level" id="vehicleThreat">
                        <div class="threat-label">Vehicle Detection</div>
                        <div class="threat-value" id="vehicleConfidence">0.00%</div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="vehicleConfidenceBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="threat-level" id="unknownThreat">
                        <div class="threat-label">Unknown Object</div>
                        <div class="threat-value" id="unknownConfidence">0.00%</div>
                        <div class="confidence-bar">
                            <div class="confidence-fill" id="unknownConfidenceBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">Radar Display</div>
                <div class="radar-container">
                    <div class="radar-grid">
                        <div class="radar-circle" style="width: 25%; height: 25%;"></div>
                        <div class="radar-circle" style="width: 50%; height: 50%;"></div>
                        <div class="radar-circle" style="width: 75%; height: 75%;"></div>
                        <div class="radar-circle" style="width: 100%; height: 100%;"></div>
                    </div>
                    <div class="radar-sweep"></div>
                    <div id="radarTargets"></div>
                </div>
                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-label">Range</div>
                        <div class="metric-value" id="rangeValue">-- m</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Velocity</div>
                        <div class="metric-value" id="velocityValue">-- m/s</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Bearing</div>
                        <div class="metric-value" id="bearingValue">--¬∞</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Altitude</div>
                        <div class="metric-value" id="altitudeValue">-- m</div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">Live Data Stream</div>
                <div class="streaming-data" id="dataStream"></div>
                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-label">Signal/Noise</div>
                        <div class="metric-value" id="snrValue">-- dB</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Amplitude</div>
                        <div class="metric-value" id="ampValue">--</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="timeline-container">
            <div class="panel-header">Person Detection Timeline</div>
            <div class="chart-container">
                <canvas id="detectionChart"></canvas>
            </div>
        </div>
    </div>
    
    <div class="detection-alert" id="detectionAlert">
        ‚ö†Ô∏è PERSON DETECTED ‚ö†Ô∏è
    </div>

    <script>
        // Global variables
        let sensorData = [];
        let currentIndex = 0;
        let streamInterval = null;
        let detectionChart = null;
        let isStreaming = false;
        let detectionHistory = [];
        const PERSON_THRESHOLD = 0.02; // 2% confidence threshold for person detection
        
        // Initialize Chart
        function initChart() {
            const ctx = document.getElementById('detectionChart').getContext('2d');
            detectionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Person Detection Confidence',
                        data: [],
                        borderColor: '#0f0',
                        backgroundColor: 'rgba(0, 255, 0, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    },
                    {
                        label: 'Alert Threshold',
                        data: [],
                        borderColor: '#ff0',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 0
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 0.1,
                            ticks: {
                                callback: function(value) {
                                    return (value * 100).toFixed(1) + '%';
                                },
                                color: '#0f0'
                            },
                            grid: {
                                color: 'rgba(0, 255, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#0f0',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: 'rgba(0, 255, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#0f0'
                            }
                        }
                    }
                }
            });
        }
        
        // Update time display
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = 
                now.toTimeString().split(' ')[0];
        }
        
        // Parse HAR file
        function parseHARFile(content) {
            try {
                const har = JSON.parse(content);
                const extracted = [];
                
                har.log.entries.forEach(entry => {
                    if (entry.response.status === 200 && entry.response.content.text) {
                        try {
                            const data = JSON.parse(entry.response.content.text);
                            if (data.result && data.result.length > 0) {
                                extracted.push({
                                    timestamp: entry.startedDateTime,
                                    data: data.result[0]
                                });
                            }
                        } catch (e) {
                            console.log('Parse error:', e);
                        }
                    }
                });
                
                return extracted;
            } catch (e) {
                console.error('HAR parse error:', e);
                return [];
            }
        }
        
        // Process sensor data point
        function processSensorData(dataPoint) {
            if (!dataPoint || !dataPoint.data) return;
            
            const data = dataPoint.data;
            const timestamp = new Date(dataPoint.timestamp).toLocaleTimeString();
            
            // Update radar metrics
            if (data.observation) {
                document.getElementById('rangeValue').textContent = 
                    data.observation.range.toFixed(1) + ' m';
                document.getElementById('velocityValue').textContent = 
                    data.observation.radialVelocity.toFixed(2) + ' m/s';
                document.getElementById('bearingValue').textContent = 
                    data.observation.azimuthAngle.toFixed(1) + '¬∞';
                
                // Add radar blip
                addRadarBlip(data.observation);
            }
            
            if (data.geolocation) {
                document.getElementById('altitudeValue').textContent = 
                    data.geolocation.altitude.toFixed(1) + ' m';
            }
            
            if (data.stats) {
                document.getElementById('snrValue').textContent = 
                    data.stats.localSnr.toFixed(1) + ' dB';
                document.getElementById('ampValue').textContent = 
                    data.stats.amplitude.toFixed(0);
                
                // Process classifications
                if (data.stats.classifications) {
                    processClassifications(data.stats.classifications, timestamp);
                }
            }
            
            // Add to data stream
            addToDataStream(data, timestamp);
        }
        
        // Process classifications
        function processClassifications(classifications, timestamp) {
            let personConf = 0;
            let vehicleConf = 0;
            let unknownConf = 0;
            
            classifications.forEach(cls => {
                if (cls.type === 'person') {
                    personConf = cls.confidence;
                } else if (cls.type.includes('vehicle')) {
                    vehicleConf = Math.max(vehicleConf, cls.confidence);
                } else if (cls.type === 'unknown') {
                    unknownConf = cls.confidence;
                }
            });
            
            // Update threat displays
            updateThreatLevel('person', personConf);
            updateThreatLevel('vehicle', vehicleConf);
            updateThreatLevel('unknown', unknownConf);
            
            // Update detection chart
            updateDetectionChart(timestamp, personConf);
            
            // Check for person detection alert
            if (personConf > PERSON_THRESHOLD) {
                triggerPersonAlert();
            }
            
            // Update system status based on detections
            updateSystemStatus(personConf, vehicleConf);
        }
        
        // Update threat level display
        function updateThreatLevel(type, confidence) {
            const percentage = (confidence * 100).toFixed(2);
            const threatEl = document.getElementById(`${type}Threat`);
            const confEl = document.getElementById(`${type}Confidence`);
            const barEl = document.getElementById(`${type}ConfidenceBar`);
            
            confEl.textContent = percentage + '%';
            barEl.style.width = percentage + '%';
            
            // Update threat level styling
            threatEl.classList.remove('high', 'medium');
            if (confidence > 0.03) {
                threatEl.classList.add('high');
            } else if (confidence > 0.01) {
                threatEl.classList.add('medium');
            }
        }
        
        // Update detection chart
        function updateDetectionChart(timestamp, confidence) {
            if (!detectionChart) return;
            
            const maxPoints = 30;
            
            detectionChart.data.labels.push(timestamp);
            detectionChart.data.datasets[0].data.push(confidence);
            detectionChart.data.datasets[1].data.push(PERSON_THRESHOLD);
            
            // Keep only last N points
            if (detectionChart.data.labels.length > maxPoints) {
                detectionChart.data.labels.shift();
                detectionChart.data.datasets[0].data.shift();
                detectionChart.data.datasets[1].data.shift();
            }
            
            detectionChart.update('none');
        }
        
        // Add radar blip
        function addRadarBlip(observation) {
            const radarTargets = document.getElementById('radarTargets');
            const blip = document.createElement('div');
            blip.className = 'target-blip';
            
            // Calculate position based on range and angle
            const maxRange = 200; // max range in meters
            const normalizedRange = Math.min(observation.range / maxRange, 1);
            const angle = observation.azimuthAngle * Math.PI / 180;
            
            const x = 50 + normalizedRange * 45 * Math.cos(angle);
            const y = 50 - normalizedRange * 45 * Math.sin(angle);
            
            blip.style.left = x + '%';
            blip.style.top = y + '%';
            
            radarTargets.appendChild(blip);
            
            // Remove blip after animation
            setTimeout(() => blip.remove(), 2000);
        }
        
        // Add to data stream display
        function addToDataStream(data, timestamp) {
            const stream = document.getElementById('dataStream');
            const line = document.createElement('div');
            line.className = 'data-line';
            
            let alertClass = '';
            let prefix = '[DATA]';
            
            // Check for alerts
            if (data.stats && data.stats.classifications) {
                const person = data.stats.classifications.find(c => c.type === 'person');
                if (person && person.confidence > PERSON_THRESHOLD) {
                    alertClass = 'danger';
                    prefix = '[ALERT]';
                } else if (person && person.confidence > 0.01) {
                    alertClass = 'alert';
                    prefix = '[WARN]';
                }
            }
            
            line.className += ' ' + alertClass;
            line.textContent = `${timestamp} ${prefix} RNG:${data.observation?.range.toFixed(1)}m ` +
                              `VEL:${data.observation?.radialVelocity.toFixed(2)}m/s ` +
                              `SNR:${data.stats?.localSnr.toFixed(1)}dB`;
            
            stream.insertBefore(line, stream.firstChild);
            
            // Keep only last 20 lines
            while (stream.children.length > 20) {
                stream.removeChild(stream.lastChild);
            }
        }
        
        // Trigger person detection alert
        function triggerPersonAlert() {
            const alert = document.getElementById('detectionAlert');
            alert.classList.add('show');
            
            // Update threat status
            const threatStatus = document.getElementById('threatStatus');
            const threatText = document.getElementById('threatLevelText');
            threatStatus.classList.add('danger');
            threatText.textContent = 'HIGH';
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                alert.classList.remove('show');
            }, 3000);
        }
        
        // Update system status
        function updateSystemStatus(personConf, vehicleConf) {
            const systemStatus = document.getElementById('systemStatus');
            const systemText = document.getElementById('systemStatusText');
            const threatStatus = document.getElementById('threatStatus');
            const threatText = document.getElementById('threatLevelText');
            
            if (personConf > PERSON_THRESHOLD) {
                systemStatus.classList.add('danger');
                systemText.textContent = 'CONTACT';
                threatStatus.classList.remove('alert');
                threatStatus.classList.add('danger');
                threatText.textContent = 'HIGH';
            } else if (personConf > 0.01 || vehicleConf > 0.01) {
                systemStatus.classList.add('alert');
                systemStatus.classList.remove('danger');
                systemText.textContent = 'TRACKING';
                threatStatus.classList.add('alert');
                threatStatus.classList.remove('danger');
                threatText.textContent = 'ELEVATED';
            } else {
                systemStatus.classList.remove('alert', 'danger');
                systemText.textContent = 'MONITORING';
                threatStatus.classList.remove('alert', 'danger');
                threatText.textContent = 'NOMINAL';
            }
        }
        
        // Start streaming
        function startStreaming() {
            if (sensorData.length === 0) return;
            
            const btn = document.getElementById('streamBtn');
            
            if (isStreaming) {
                // Stop streaming
                clearInterval(streamInterval);
                isStreaming = false;
                btn.textContent = 'START STREAM';
                btn.classList.remove('active');
                
                const dataStatus = document.getElementById('dataStatus');
                const dataText = document.getElementById('dataStreamText');
                dataStatus.classList.remove('alert');
                dataText.textContent = 'PAUSED';
            } else {
                // Start streaming
                isStreaming = true;
                btn.textContent = 'STOP STREAM';
                btn.classList.add('active');
                
                const dataStatus = document.getElementById('dataStatus');
                const dataText = document.getElementById('dataStreamText');
                dataStatus.classList.add('alert');
                dataText.textContent = 'ACTIVE';
                
                streamInterval = setInterval(() => {
                    if (currentIndex < sensorData.length) {
                        processSensorData(sensorData[currentIndex]);
                        currentIndex++;
                    } else {
                        // Loop back to beginning
                        currentIndex = 0;
                    }
                }, 500); // Process every 500ms for dramatic effect
            }
        }
        
        // Load data from file
        function loadData() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('SELECT HAR FILE FOR ANALYSIS');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                sensorData = parseHARFile(e.target.result);
                if (sensorData.length > 0) {
                    currentIndex = 0;
                    document.getElementById('streamBtn').disabled = false;
                    document.getElementById('resetBtn').disabled = false;
                    
                    const dataStatus = document.getElementById('dataStatus');
                    const dataText = document.getElementById('dataStreamText');
                    dataStatus.classList.remove('danger');
                    dataText.textContent = 'READY';
                    
                    console.log(`LOADED ${sensorData.length} DATA POINTS`);
                } else {
                    alert('NO VALID SENSOR DATA FOUND IN FILE');
                }
            };
            reader.readAsText(file);
        }
        
        // Reset system
        function resetSystem() {
            // Stop streaming
            if (isStreaming) {
                startStreaming();
            }
            
            // Reset index
            currentIndex = 0;
            
            // Clear displays
            document.getElementById('dataStream').innerHTML = '';
            document.getElementById('radarTargets').innerHTML = '';
            
            // Reset threat levels
            ['person', 'vehicle', 'unknown'].forEach(type => {
                updateThreatLevel(type, 0);
            });
            
            // Reset chart
            if (detectionChart) {
                detectionChart.data.labels = [];
                detectionChart.data.datasets[0].data = [];
                detectionChart.data.datasets[1].data = [];
                detectionChart.update();
            }
            
            // Reset metrics
            document.getElementById('rangeValue').textContent = '-- m';
            document.getElementById('velocityValue').textContent = '-- m/s';
            document.getElementById('bearingValue').textContent = '--¬∞';
            document.getElementById('altitudeValue').textContent = '-- m';
            document.getElementById('snrValue').textContent = '-- dB';
            document.getElementById('ampValue').textContent = '--';
            
            // Reset statuses
            document.getElementById('systemStatus').classList.remove('alert', 'danger');
            document.getElementById('systemStatusText').textContent = 'STANDBY';
            document.getElementById('threatStatus').classList.remove('alert', 'danger');
            document.getElementById('threatLevelText').textContent = 'NOMINAL';
            document.getElementById('dataStreamText').textContent = 'READY';
        }
        
        // Event listeners
        document.getElementById('loadBtn').addEventListener('click', loadData);
        document.getElementById('streamBtn').addEventListener('click', startStreaming);
        document.getElementById('resetBtn').addEventListener('click', resetSystem);
        
        // Initialize
        window.onload = function() {
            initChart();
            setInterval(updateTime, 1000);
            updateTime();
        };
    </script>
</body>
</html>